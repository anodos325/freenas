#!/sbin/openrc-run
#
# $FreeBSD$
#

name="ix-syncdisks"

depend()
{
	provide ix-syncdisks
}

start()
{
	touch /tmp/.sync_disk_done
	/usr/local/bin/midclt call disk.sync_all > /dev/null
	/usr/local/bin/midclt call disk.multipath_sync > /dev/null
	if [ "$(/usr/local/bin/midclt call system.is_freenas)" = "False" ]; then
		checkyesno failover_enable || /usr/local/bin/midclt call notifier.zpool_enclosure_sync 2> /dev/null
	fi
}

